<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title data-at="REGtitle">LuckyGame</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          type="text/css">
</head>
<body>
<nav class="navbar navbar-dark navbar-expand-lg navbar-light bg-success mb-5">
    <a class="navbar-brand text-white" href="https://deveducation.com/ua/">LuckyGame</a>
</nav>

<iframe name="defame" id="defame" style="display: none;"></iframe>
<form id="form" class="row justify-content-center w-25 bg-white h-auto m-auto p-2 rounded border border-secondary"
      action="/" target="defame">
    <div class="form-group">
        <label for="username" class="sr-only">Username</label>

        <input data-at="REGusernameInput" type="text" class="form-control" placeholder="User name" id="username"
               name="username" required
               autofocus>
    </div>
    <div class="form-group">
        <label for="email" class="sr-only">Email</label>
        <input data-at="REGemailInput" type="text" class="form-control" placeholder="Email" id="email" name="email"
               required autofocus>
    </div>
    <div class="form-group">
        <label for="password" class="sr-only">Password</label>
        <input data-at="REGpassInput" type="password" class="form-control" placeholder="Password" id="password"
               name="password" required>
    </div>
    <div class="form-group">
        <input data-at="REGconfPassInput" type="password" class="form-control" placeholder="Confirm password"
               name="confirmPassword"
               id="confirmPassword" required>
    </div>
    <div class="w-100"></div>
    <input data-at="REGsignUpBtn" type=submit onclick="login()" form="form" value="Sign-up"/>
</form>
<script>
    function login() {
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const username = document.getElementById('username').value;
        const confirmPassword = document.getElementById('confirmPassword').value;


        if (email.length >= 8 && password.length >= 8 && username.length >= 5 && confirmPassword === password) {
            let xhr = new XMLHttpRequest();
            xhr.open("POST", "/api/auth/signup");
            xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
            let data = JSON.stringify({"email": email, "password": password, "username": username});

            xhr.send(data);
            xhr.onreadystatechange = function () {
                if (this.status === 200) {
                    window.location.href = "/";
                }
            };
        }
    };
</script>
</body>
</html>